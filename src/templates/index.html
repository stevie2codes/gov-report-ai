{% extends "base.html" %}

{% block title %}Home - Gov-Report-AI{% endblock %}

{% block content %}
<div class="text-center mb-12">
    <h1 class="text-4xl font-bold gov-primary mb-4">
        AI-Powered Government Report Generation
    </h1>
    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
        Transform your CSV/XLSX data into professional, compliance-ready government reports using artificial intelligence.
    </p>
</div>

<!-- File Upload Section -->
<div class="card max-w-4xl mx-auto mb-8">
    <div class="text-center mb-6">
        <h2 class="text-2xl font-semibold gov-primary mb-2">
            <i class="fas fa-upload mr-2"></i>Upload Your Data
        </h2>
        <p class="text-gray-600">Upload a CSV or Excel file to get started with AI-powered report planning</p>
    </div>
    
    <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data" class="space-y-6">
        <div>
            <label for="file" class="form-label">Select File</label>
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                <input type="file" id="file" name="file" accept=".csv,.xlsx,.xls" 
                       class="hidden" onchange="updateFileName(this)">
                <label for="file" class="cursor-pointer">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="text-lg text-gray-600 mb-2">Click to upload or drag and drop</p>
                    <p class="text-sm text-gray-500">CSV, XLSX, or XLS files up to 10MB</p>
                </label>
            </div>
            <div id="file-info" class="mt-2 text-sm text-gray-600 hidden"></div>
        </div>
        
        <div class="text-center">
            <button type="submit" class="btn-primary text-lg px-8 py-3">
                <i class="fas fa-rocket mr-2"></i>Process Data & Plan Report
            </button>
        </div>
    </form>
</div>

<!-- Features Section -->
<div class="grid md:grid-cols-3 gap-8 mb-8">
    <div class="card text-center">
        <div class="text-4xl text-blue-500 mb-4">
            <i class="fas fa-brain"></i>
        </div>
        <h3 class="text-xl font-semibold gov-primary mb-2">AI-Powered Planning</h3>
        <p class="text-gray-600">Describe your report in natural language and let AI generate the perfect specification with KPIs, charts, and tables.</p>
    </div>
    
    <div class="card text-center">
        <div class="text-4xl text-green-500 mb-4">
            <i class="fas fa-chart-bar"></i>
        </div>
        <h3 class="text-xl font-semibold gov-primary mb-2">Smart Data Analysis</h3>
        <p class="text-gray-600">Automatic column type detection, data profiling, and intelligent insights from your government datasets.</p>
    </div>
    
    <div class="card text-center">
        <div class="text-4xl text-purple-500 mb-4">
            <i class="fas fa-file-alt"></i>
        </div>
        <h3 class="text-xl font-semibold gov-primary mb-2">Government Templates</h3>
        <p class="text-gray-600">Pre-built templates for budget reports, balance sheets, response times, and more government use cases.</p>
    </div>
</div>

<!-- AI Status Section -->
{% if ai_available %}
<div class="card max-w-4xl mx-auto mb-8 bg-green-50 border-green-200">
    <div class="flex items-center">
        <div class="text-green-500 text-2xl mr-3">
            <i class="fas fa-check-circle"></i>
        </div>
        <div>
            <h3 class="text-lg font-semibold text-green-800">AI Planning Available</h3>
            <p class="text-green-700">OpenAI integration is active. You can use natural language to describe your reports!</p>
        </div>
    </div>
</div>
{% else %}
<div class="card max-w-4xl mx-auto mb-8 bg-yellow-50 border-yellow-200">
    <div class="flex items-center">
        <div class="text-yellow-500 text-2xl mr-3">
            <i class="fas fa-exclamation-triangle"></i>
        </div>
        <div>
            <h3 class="text-lg font-semibold text-yellow-800">AI Planning Limited</h3>
            <p class="text-yellow-700">No OpenAI API key found. Reports will be generated using template-based planning.</p>
            <p class="text-sm text-yellow-600 mt-1">Set OPENAI_API_KEY environment variable for full AI functionality.</p>
        </div>
    </div>
</div>
{% endif %}

<!-- Quick Start Section -->
<div class="card max-w-4xl mx-auto">
    <h3 class="text-xl font-semibold gov-primary mb-4">
        <i class="fas fa-play-circle mr-2"></i>Quick Start
    </h3>
    <div class="space-y-4">
        <div class="flex items-start">
            <div class="bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center text-sm font-semibold mr-3 mt-1">1</div>
            <div>
                <h4 class="font-medium text-gray-800">Upload Your Data</h4>
                <p class="text-gray-600 text-sm">Upload a CSV or Excel file containing your government data</p>
            </div>
        </div>
        <div class="flex items-start">
            <div class="bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center text-sm font-semibold mr-3 mt-1">2</div>
            <div>
                <h4 class="font-medium text-gray-800">Describe Your Report</h4>
                <p class="text-gray-600 text-sm">Tell us what kind of report you need in plain English</p>
            </div>
        </div>
        <div class="flex items-start">
            <div class="bg-blue-100 text-blue-600 rounded-full w-8 h-8 flex items-center justify-center text-sm font-semibold mr-3 mt-1">3</div>
            <div>
                <h4 class="font-medium text-gray-800">Get AI-Generated Plan</h4>
                <p class="text-gray-600 text-sm">Receive a complete report specification with KPIs, charts, and tables</p>
            </div>
        </div>
    </div>
</div>

<!-- Sample Data Section -->
<div class="mt-8 text-center">
    <button onclick="loadSampleData()" class="btn-secondary">
        <i class="fas fa-eye mr-2"></i>View Sample Data
    </button>
</div>

<!-- Sample Data Modal -->
<div id="sampleModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold gov-primary">Sample Government Data</h3>
                    <button onclick="closeSampleModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <pre class="text-sm text-gray-800 overflow-x-auto">Department,Budget,Actual,Variance,Date
Finance,$1,200,000,$1,180,000,-1.67%,2024-01-01
Public Works,$850,000,$870,000,2.35%,2024-01-01
Health,$650,000,$620,000,-4.62%,2024-01-01
Police,$1,100,000,$1,050,000,-4.55%,2024-01-01
Permitting,$300,000,$320,000,6.67%,2024-01-01</pre>
                </div>
                <p class="text-sm text-gray-600 mt-4">
                    This sample data shows budget vs actual spending across city departments. 
                    You can copy this data to test the system or use your own government datasets.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
function updateFileName(input) {
    const fileInfo = document.getElementById('file-info');
    if (input.files && input.files[0]) {
        const file = input.files[0];
        fileInfo.innerHTML = `
            <i class="fas fa-file mr-2"></i>
            <strong>${file.name}</strong> (${(file.size / 1024).toFixed(1)} KB)
        `;
        fileInfo.classList.remove('hidden');
    } else {
        fileInfo.classList.add('hidden');
    }
}

function loadSampleData() {
    document.getElementById('sampleModal').classList.remove('hidden');
}

function closeSampleModal() {
    document.getElementById('sampleModal').classList.add('hidden');
}

// Close modal when clicking outside
document.getElementById('sampleModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeSampleModal();
    }
});
</script>
{% endblock %}
